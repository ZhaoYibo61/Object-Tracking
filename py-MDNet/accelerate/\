import sys

from options import *

sys.path.insert(0, '../modules')
from model import *

np.random.seed(123)
torch.manual_seed(456)
torch.cuda.manual_seed(789)

def svd_approx(model):
    
    print("model: %s" %type(model))
    print(type(model.layers.fc4))
    
    # this returns an iterator
    print(type(model.layers.fc5.parameters()))

    # 
    for name, param in model.layers.fc5.named_parameters():
        print(name, param.size())
        print(type(param))

    # access fc4 params

    # svd
    
    # choose proper k (# of rank using) (guess one for now)
    
    # done?

if __name__ == "__main__":

    # init model
    model = MDNet(opts['model_path'])
    if opts['use_gpu']:
        model = model.cuda()
    model.set_learnable_params(opts['ft_layers'])

    # call function
    svd_approx(model)



